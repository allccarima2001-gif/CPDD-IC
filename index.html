<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CPDD-IC - Cuestionario Dermatolog√≠a UNMSM</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: Arial, sans-serif; background: linear-gradient(135deg, #003366 0%, #004d99 100%); min-height: 100vh; display: flex; justify-content: center; align-items: center; padding: 20px; }
        .container { background: white; border-radius: 10px; box-shadow: 0 10px 40px rgba(0,0,0,0.3); max-width: 900px; width: 100%; padding: 40px; }
        h1 { color: #003366; margin-bottom: 15px; font-size: 28px; text-align: center; }
        h2 { color: #003366; margin: 20px 0 15px 0; font-size: 20px; }
        p { color: #666; margin-bottom: 15px; line-height: 1.6; }
        .form-group { margin-bottom: 20px; }
        label { display: block; color: #003366; font-weight: bold; margin-bottom: 8px; }
        input[type="number"], select { width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 5px; font-size: 14px; }
        input:focus, select:focus { outline: none; border-color: #003366; }
        .radio-group { display: flex; gap: 30px; margin-top: 10px; flex-wrap: wrap; }
        .radio-option { display: flex; align-items: center; }
        .radio-option input { margin-right: 8px; }
        .radio-option label { margin: 0; display: inline; }
        button { padding: 12px 30px; font-size: 14px; border: none; border-radius: 5px; cursor: pointer; background: #003366; color: white; font-weight: bold; transition: all 0.3s; }
        button:hover { background: #004d99; }
        .btn-anterior { background: #666; }
        .btn-anterior:hover { background: #444; }
        .error { color: red; font-size: 12px; margin-top: 5px; }
        .hidden { display: none !important; }
        .image-container { text-align: center; margin: 30px 0; }
        .image-container img { max-width: 100%; height: 400px; object-fit: contain; border-radius: 10px; border: 3px solid #003366; }
        .progress-bar { width: 100%; height: 10px; background: #e0e0e0; border-radius: 10px; margin-bottom: 20px; overflow: hidden; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, #003366, #004d99); }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; font-size: 13px; }
        table th, table td { border: 1px solid #ddd; padding: 10px; text-align: left; }
        table th { background: #003366; color: white; }
        table tr:nth-child(even) { background: #f9f9f9; }
        .buttons { display: flex; gap: 10px; margin-top: 20px; }
        .buttons button { flex: 1; }
        .intro-box { background: #f0f4f8; padding: 25px; border-radius: 10px; margin-bottom: 20px; border-left: 5px solid #003366; }
        .intro-box h2 { margin-top: 0; }
        .intro-box ul { margin-left: 20px; color: #333; line-height: 1.8; }
        .result-box { background: #f0f4f8; padding: 20px; border-radius: 10px; margin-bottom: 20px; border-left: 5px solid #003366; }
        .result-item { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #ddd; }
        .result-item:last-child { border-bottom: none; }
        .precision-display { font-size: 32px; font-weight: bold; color: #003366; text-align: center; }
    </style>
</head>
<body>
    <div class="container">
        <!-- P√ÅGINA INICIO -->
        <div id="page-inicio">
            <h1>üìã Cuestionario CPDD-IC</h1>
            <p style="text-align:center;font-size:16px;margin-bottom:30px;">Precisi√≥n Diagn√≥stica en Dermatolog√≠a mediante Im√°genes Cl√≠nicas</p>
            <p style="text-align:center;font-size:14px;color:#555;">Universidad Nacional Mayor de San Marcos - 2025</p>
            
            <div class="intro-box">
                <h2>‚ÑπÔ∏è Instrucciones</h2>
                <ul>
                    <li>Este cuestionario eval√∫a tu capacidad diagn√≥stica</li>
                    <li>Consta de 15 preguntas con im√°genes cl√≠nicas</li>
                    <li>Duraci√≥n aproximada: 25-30 minutos</li>
                    <li>Responde de forma individual e independiente</li>
                    <li>Tus respuestas son confidenciales</li>
                </ul>
            </div>
            
            <div style="text-align:center;">
                <button onclick="irA('demo')" style="padding:15px 50px;font-size:16px;">Comenzar ‚Üí</button>
            </div>
        </div>

        <!-- P√ÅGINA DATOS DEMOGR√ÅFICOS -->
        <div id="page-demo" class="hidden">
            <h2>üìù Datos Demogr√°ficos</h2>
            
            <div class="form-group">
                <label>Edad (a√±os):</label>
                <input type="number" id="edad" min="18" max="60" placeholder="Ej: 24">
                <div id="error-edad" class="error"></div>
            </div>
            
            <div class="form-group">
                <label>Sexo biol√≥gico:</label>
                <div class="radio-group">
                    <div class="radio-option">
                        <input type="radio" name="sexo" value="M" id="m">
                        <label for="m">Masculino</label>
                    </div>
                    <div class="radio-option">
                        <input type="radio" name="sexo" value="F" id="f">
                        <label for="f">Femenino</label>
                    </div>
                </div>
                <div id="error-sexo" class="error"></div>
            </div>
            
            <div class="form-group">
                <label>Instituci√≥n:</label>
                <select id="inst">
                    <option value="">-- Selecciona --</option>
                    <option value="MINSA">MINSA</option>
                    <option value="EsSalud">EsSalud</option>
                    <option value="FFAA">Fuerzas Armadas</option>
                    <option value="Privadas">Cl√≠nicas privadas</option>
                </select>
                <div id="error-inst" class="error"></div>
            </div>
            
            <button onclick="validarDemo()">Siguiente ‚Üí</button>
        </div>

        <!-- P√ÅGINAS PREGUNTAS -->
        <div id="preguntas"></div>

        <!-- P√ÅGINA RESULTADOS -->
        <div id="page-res" class="hidden">
            <h2>üìä Resultados Finales</h2>
            <div id="res"></div>
        </div>
    </div>

    <script>
        const GOOGLE_APPS_SCRIPT_URL = "PEGA_TU_URL_AQUI";

        const preguntas = [
            { num: 1, correcto: "Dermatitis de contacto al√©rgica", imagen: "Dermatitis-de-contacto.jpg" },
            { num: 2, correcto: "Dermatitis at√≥pica", imagen: "Dermatitis-atopica.jpg" },
            { num: 3, correcto: "Queratosis seborreica", imagen: "Queratosis-seborreica.jpg" },
            { num: 4, correcto: "Imp√©tigo no bulloso", imagen: "Impetigo.jpg" },
            { num: 5, correcto: "Psoriasis", imagen: "Psoriasis.jpg" },
            { num: 6, correcto: "Melanoma", imagen: "Melanoma.jpg" },
            { num: 7, correcto: "Acn√© vulgar", imagen: "Acne.jpg" },
            { num: 8, correcto: "Verruga vulgar", imagen: "Verruga-vulgar.jpg" },
            { num: 9, correcto: "Ros√°cea", imagen: "Rosacea.jpg" },
            { num: 10, correcto: "Ti√±a corporis", imagen: "Tina-corporis.jpg" },
            { num: 11, correcto: "Carcinoma basocelular", imagen: "Carcinoma-basocelular.jpg" },
            { num: 12, correcto: "Nevo melanoc√≠tico com√∫n", imagen: "Nevus.jpg" },
            { num: 13, correcto: "Lentigo solar", imagen: "Lentigo-solar.jpg" },
            { num: 14, correcto: "Queratosis act√≠nica", imagen: "Queratosis-actinica.jpg" },
            { num: 15, correcto: "Molusco contagioso", imagen: "Molusco-contagioso.jpg" }
        ];

        const opciones = ["Acn√© vulgar","Carcinoma basocelular","Dermatitis at√≥pica","Dermatitis de contacto al√©rgica","Imp√©tigo no bulloso","Lentigo solar","Melanoma","Molusco contagioso","Nevo melanoc√≠tico com√∫n","Psoriasis","Queratosis act√≠nica","Queratosis seborreica","Ros√°cea","Ti√±a corporis","Verruga vulgar"];

        let datos = {};

        window.onload = function() {
            crearPreguntas();
        };

        function crearPreguntas() {
            const c = document.getElementById('preguntas');
            preguntas.forEach(p => {
                const d = document.createElement('div');
                d.id = 'p' + p.num;
                d.className = 'hidden';
                d.innerHTML = `
                    <div class="progress-bar"><div class="progress-fill" style="width:${p.num*100/15}%"></div></div>
                    <h2>Pregunta ${p.num} de 15</h2>
                    <p style="text-align:center;color:#666;margin-bottom:15px;">Observe la imagen y seleccione el diagn√≥stico m√°s probable:</p>
                    <div class="image-container">
                        <img src="${p.imagen}" alt="Pregunta ${p.num}">
                    </div>
                    <div class="form-group">
                        <label>Diagn√≥stico:</label>
                        <select id="r${p.num}">
                            <option value="">-- Selecciona una opci√≥n --</option>
                            ${opciones.map(o => `<option value="${o}">${o}</option>`).join('')}
                        </select>
                        <div id="err${p.num}" class="error"></div>
                    </div>
                    <div class="buttons">
                        ${p.num > 1 ? `<button class="btn-anterior" onclick="irA('p${p.num-1}')">‚Üê Anterior</button>` : '<div></div>'}
                        <button onclick="next(${p.num})">
                            ${p.num === 15 ? '‚úì Finalizar' : 'Siguiente ‚Üí'}
                        </button>
                    </div>
                `;
                c.appendChild(d);
            });
        }

        function irA(p) {
            document.querySelectorAll('[id^="page-"],[id^="p"]').forEach(e => e.classList.add('hidden'));
            if(document.getElementById(p)) {
                document.getElementById(p).classList.remove('hidden');
            }
            window.scrollTo(0, 0);
        }

        function validarDemo() {
            const edad = document.getElementById('edad').value;
            const sexo = document.querySelector('input[name="sexo"]:checked');
            const inst = document.getElementById('inst').value;

            document.getElementById('error-edad').textContent = '';
            document.getElementById('error-sexo').textContent = '';
            document.getElementById('error-inst').textContent = '';

            let ok = true;
            if(!edad || edad < 18 || edad > 60) { 
                document.getElementById('error-edad').textContent = '‚ö†Ô∏è Edad debe estar entre 18-60';
                ok = false;
            }
            if(!sexo) { 
                document.getElementById('error-sexo').textContent = '‚ö†Ô∏è Selecciona tu sexo';
                ok = false;
            }
            if(!inst) { 
                document.getElementById('error-inst').textContent = '‚ö†Ô∏è Selecciona instituci√≥n';
                ok = false;
            }

            if(ok) {
                datos = {
                    edad: edad,
                    sexo: sexo.value,
                    inst: inst,
                    r: {}
                };
                irA('p1');
            }
        }

        function next(n) {
            const r = document.getElementById('r' + n).value;
            if(!r) { 
                document.getElementById('err' + n).textContent = '‚ö†Ô∏è Debes seleccionar un diagn√≥stico';
                return;
            }
            document.getElementById('err' + n).textContent = '';
            datos.r[n] = r;
            if(n === 15) mostrarResultados();
            else irA('p' + (n + 1));
        }

        function mostrarResultados() {
            let correctas = 0;
            preguntas.forEach(p => {
                if(datos.r[p.num] === p.correcto) correctas++;
            });
            datos.precision = Math.round(correctas*100/15);

            let tabla = '<table><tr><th>P</th><th>Tu respuesta</th><th>Respuesta correcta</th><th>Resultado</th></tr>';
            preguntas.forEach(p => {
                const ok = datos.r[p.num] === p.correcto;
                tabla += `<tr><td>P${p.num}</td><td>${datos.r[p.num]}</td><td>${p.correcto}</td><td style="color:${ok?'green':'red'};font-weight:bold">${ok?'‚úì Correcto':'‚úó Incorrecto'}</td></tr>`;
            });
            tabla += '</table>';

            let html = `
                <div class="result-box">
                    <div class="result-item">
                        <strong>Respuestas correctas:</strong>
                        <span>${correctas} / 15</span>
                    </div>
                    <div class="result-item">
                        <strong>Respuestas incorrectas:</strong>
                        <span>${15 - correctas} / 15</span>
                    </div>
                    <div style="text-align:center;margin-top:20px;padding-top:20px;border-top:2px solid #003366;">
                        <p style="color:#666;margin-bottom:5px;">PRECISI√ìN GLOBAL</p>
                        <p class="precision-display">${datos.precision}%</p>
                    </div>
                </div>
                <h3 style="color:#003366;margin:30px 0 15px;">Detalle de respuestas:</h3>
                ${tabla}
                <div style="text-align:center;margin-top:30px;">
                    <button onclick="enviarDatos()">üì§ Enviar datos a Google Sheets</button>
                </div>
            `;

            document.getElementById('res').innerHTML = html;
            irA('page-res');
        }

        function enviarDatos() {
            if(!GOOGLE_APPS_SCRIPT_URL || GOOGLE_APPS_SCRIPT_URL.includes('https://script.google.com/macros/s/AKfycbxIaE-VKXXdLpnkKxa2fZoivpAq9jQSuxHFS0_8XohKnHZsHRv5zWqTfBsabo9VL8oh/exec')) {
                alert('‚ö†Ô∏è Configura la URL de Google Apps Script en el c√≥digo');
                return;
            }

            fetch(GOOGLE_APPS_SCRIPT_URL, {
                method: "POST",
                body: JSON.stringify(datos)
            })
            .then(r => r.json())
            .then(result => {
                alert('‚úì Datos enviados correctamente');
            })
            .catch(e => {
                alert('‚ö†Ô∏è Error: ' + e.message);
                console.log(e);
            });
        }
    </script>
</body>
</html>
